[
  {
    "Id": "257579",
    "ThreadId": "75276",
    "Html": "<p>Hi everyone!</p>\r\n<p>I performed stress testing of site based on Kigg Framework and at some point (approximately after 15 - 20 minutes) huge amount of errors occurs. Seems that there are problems with opening and closing data connections, which is kinda strange, because DataContext is wrapped into UnitOfWork, so connections disposing should be done automatically. I would really appreciate your solutions or guesses. Here are exceptions that i got from log file:</p>\r\n<p>&nbsp;</p>\r\n<pre>1) Timestamp: 11/16/2009 5:06:23 PM\r\n              Message: System.Web.HttpUnhandledException: Exception of type 'System.Web.HttpUnhandledException' was thrown. ---&gt; System.InvalidOperationException: There is already an open DataReader associated with this Command which must be closed first.\r\n   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)\r\n   at System.Data.SqlClient.SqlConnection.ValidateConnectionForExecute(String method, SqlCommand command)\r\n   at System.Data.SqlClient.SqlCommand.ValidateCommand(String method, Boolean async)\r\n   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)\r\n   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)\r\n   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)\r\n   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)\r\n   at System.Data.Common.DbCommand.ExecuteReader()\r\n   at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult)\r\n   at System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries)\r\n   at System.Data.Linq.SqlClient.SqlProvider.CompiledQuery.Execute(IProvider provider, Object[] arguments)\r\n   at System.Data.Linq.CommonDataServices.DeferredSourceFactory`1.ExecuteKeyQuery(Object[] keyValues)\r\n   at System.Data.Linq.CommonDataServices.DeferredSourceFactory`1.Execute(Object instance)\r\n   at System.Data.Linq.CommonDataServices.DeferredSourceFactory`1.DeferredSource.GetEnumerator()\r\n   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)\r\n   at System.Data.Linq.Link`1.get_Value()\r\n   at Kigg.DomainObjects.Story.get_HtmlDescription() in D:\\Workspace\\ASP.NET\\boom\\LinqToSql\\Database.designer.cs:line 1146\r\n   at ASP.views_story_story_ascx.__Render__control1(HtmlTextWriter __w, Control parameterContainer) in c:\\HostingSpaces\\gsmnews\\test.gsm-news.net\\wwwroot\\Views\\Story\\Story.ascx:line 178\r\n   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)\r\n   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)\r\n   at System.Web.UI.Control.Render(HtmlTextWriter writer)\r\n   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)\r\n   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)\r\n   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)\r\n   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)\r\n   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)\r\n   at System.Web.UI.Page.Render(HtmlTextWriter writer)\r\n   at System.Web.Mvc.ViewPage.Render(HtmlTextWriter writer)\r\n   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)\r\n   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)\r\n   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)\r\n   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)\r\n</pre>\r\n<p>&nbsp;</p>\r\n<pre>2) Timestamp: 11/16/2009 5:11:24 PM<br>              Message: System.Web.HttpUnhandledException: Exception of type 'System.Web.HttpUnhandledException' was thrown. ---&gt; System.InvalidOperationException: Invalid attempt to call FieldCount when reader is closed.<br>   at System.Data.SqlClient.SqlDataReader.get_FieldCount()<br>   at System.Data.Linq.SqlClient.ObjectReaderCompiler.ObjectReaderSession`1.GetActiveNames()<br>   at System.Data.Linq.SqlClient.ObjectReaderCompiler.ObjectReaderBase`1.Buffer()<br>   at System.Data.Linq.SqlClient.ObjectReaderCompiler.ObjectReaderSession`1.Buffer()<br>   at System.Data.Linq.SqlClient.ObjectReaderCompiler.ObjectReaderSession`1.CompleteUse()<br>   at System.Data.Linq.SqlClient.SqlConnectionManager.BootUser(IConnectionUser user)<br>   at System.Data.Linq.SqlClient.SqlConnectionManager.UseConnection(IConnectionUser user)<br>   at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult)<br>   at System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries)<br>   at System.Data.Linq.SqlClient.SqlProvider.CompiledQuery.Execute(IProvider provider, Object[] arguments)<br>   at System.Data.Linq.CommonDataServices.DeferredSourceFactory`1.ExecuteKeyQuery(Object[] keyValues)<br>   at System.Data.Linq.CommonDataServices.DeferredSourceFactory`1.Execute(Object instance)<br>   at System.Data.Linq.CommonDataServices.DeferredSourceFactory`1.DeferredSource.GetEnumerator()<br>   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)<br>   at System.Data.Linq.Link`1.get_Value()<br>   at Kigg.DomainObjects.Story.get_HtmlDescription() in D:\\Workspace\\ASP.NET\\boom\\LinqToSql\\Database.designer.cs:line 1146<br>   at ASP.views_story_story_ascx.__Render__control1(HtmlTextWriter __w, Control parameterContainer) in c:\\HostingSpaces\\gsmnews\\test.gsm-news.net\\wwwroot\\Views\\Story\\Story.ascx:line 178<br>   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)<br>   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)<br>   at System.Web.UI.Control.Render(HtmlTextWriter writer)<br>   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)<br>   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)<br>   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)<br>   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)<br>   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)<br>   at System.Web.UI.Page.Render(HtmlTextWriter writer)<br>   at System.Web.Mvc.ViewPage.Render(HtmlTextWriter writer)<br>   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)<br>   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)<br>   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)<br>   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)<br></pre>\r\n<p>\r\n<pre><br>3) Timestamp: 11/16/2009 5:11:25 PM\r\n              Message: System.Web.HttpUnhandledException: Exception of type 'System.Web.HttpUnhandledException' was thrown. ---&gt; System.ObjectDisposedException: Cannot access a disposed object.\r\nObject name: 'DataContext accessed after Dispose.'.\r\n   at System.Data.Linq.CommonDataServices.DeferredSourceFactory`1.ExecuteKeyQuery(Object[] keyValues)\r\n   at System.Data.Linq.CommonDataServices.DeferredSourceFactory`1.Execute(Object instance)\r\n   at System.Data.Linq.CommonDataServices.DeferredSourceFactory`1.DeferredSource.GetEnumerator()\r\n   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)\r\n   at System.Data.Linq.Link`1.get_Value()\r\n   at Kigg.DomainObjects.Story.get_HtmlDescription() in D:\\Workspace\\ASP.NET\\boom\\LinqToSql\\Database.designer.cs:line 1146\r\n   at ASP.views_story_story_ascx.__Render__control1(HtmlTextWriter __w, Control parameterContainer) in c:\\HostingSpaces\\gsmnews\\test.gsm-news.net\\wwwroot\\Views\\Story\\Story.ascx:line 178\r\n   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)\r\n   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)\r\n   at System.Web.UI.Control.Render(HtmlTextWriter writer)\r\n   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)\r\n   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)\r\n   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)\r\n   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)\r\n   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)\r\n   at System.Web.UI.Page.Render(HtmlTextWriter writer)\r\n   at System.Web.Mvc.ViewPage.Render(HtmlTextWriter writer)\r\n   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)\r\n   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)\r\n   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)\r\n   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)\r\n</pre>\r\n</p>\r\n<p>\r\n<pre><br>4) Timestamp: 11/16/2009 5:15:20 PM\r\n              Message: System.InvalidCastException: Unable to cast object of type 'System.DateTime' to type 'System.String'.\r\n   at System.Data.SqlClient.SqlBuffer.get_String()\r\n   at System.Data.SqlClient.SqlDataReader.GetString(Int32 i)\r\n   at Read_Story(ObjectMaterializer`1 )\r\n   at System.Data.Linq.SqlClient.ObjectReaderCompiler.ObjectReader`2.MoveNext()\r\n   at System.Linq.Enumerable.d__aa`1.MoveNext()\r\n   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)\r\n   at Kigg.PagedResult`1..ctor(IEnumerable`1 result, Int32 total) in D:\\Workspace\\ASP.NET\\boom\\Core\\Helper\\PagedResult.cs:line 17\r\n   at Kigg.Repository.LinqToSql.BaseRepository`2.BuildPagedResult[T](IEnumerable entities, Int32 total) in D:\\Workspace\\ASP.NET\\boom\\LinqToSql\\Repository\\BaseRepository.cs:line 47\r\n   at Kigg.Repository.LinqToSql.StoryRepository.FindNews(Int32 start, Int32 max) in D:\\Workspace\\ASP.NET\\boom\\LinqToSql\\Repository\\StoryRepository.cs:line 175\r\n   at Kigg.Repository.DecoratedStoryRepository.FindNews(Int32 start, Int32 max) in D:\\Workspace\\ASP.NET\\boom\\Core\\Repository\\Decorated\\DecoratedStoryRepository.cs:line 85\r\n   at Kigg.Repository.DecoratedStoryRepository.FindNews(Int32 start, Int32 max) in D:\\Workspace\\ASP.NET\\boom\\Core\\Repository\\Decorated\\DecoratedStoryRepository.cs:line 85\r\n   at Kigg.Repository.CachingStoryRepository.FindNews(Int32 start, Int32 max) in D:\\Workspace\\ASP.NET\\boom\\Core\\Repository\\Decorated\\Caching\\CachingStoryRepository.cs:line 121\r\n   at Kigg.Web.StoryController.News(Nullable`1 page) in D:\\Workspace\\ASP.NET\\boom\\Web\\Controllers\\StoryController.cs:line 341\r\n   at lambda_method(ExecutionScope , ControllerBase , Object[] )\r\n   at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)\r\n   at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)\r\n   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)\r\n   at System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClassa.b__7()\r\n   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)\r\n   at System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClassa.&lt;&gt;c__DisplayClassc.b__9()\r\n   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters)\r\n   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)\r\n              Category: General\r\n              Priority: -1\r\n              EventId: 0\r\n              Severity: Error\r\n              Title:Unable to cast object of type 'System.DateTime' to type 'System.String'.\r\n              Machine: LEAF\r\n              Application Domain: /LM/W3SVC/264/ROOT-4-129028643419756330\r\n              Process Id: 43496\r\n              Process Name: C:\\Windows\\SysWOW64\\inetsrv\\w3wp.exe\r\n              Win32 Thread Id: 12040\r\n              Thread Name: \r\n              Extended Properties: page - 1\r\n              controller - Story\r\n              action - News\r\n</pre>\r\n</p>\r\n<p>Thanks!</p>",
    "PostedDate": "2009-11-16T10:01:17.023-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "997464",
    "ThreadId": "75276",
    "Html": "Yeh, I haved noticed the same thing. Not sure what the cause is. \r<br />\n<br />\nDid you ever solve your problem?<br />\n",
    "PostedDate": "2013-02-06T11:05:58.593-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]